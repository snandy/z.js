/*!
 * Z.js v0.1.0
 * @snandy 2014-05-06 19:36:46
 *
 */
Z.declareUI("Dragdrop",function(){var t=Z(window),e=Z(document);e[0];var n=Z.Function,i=/^xy$/;this.init=function(t,e){this.elem=Z.isElement(t)?t:Z(t)[0],this.reset(e),this.dragObj.data("originData",Z.extend({},e));var i=n.bind(this.onMousedown,this);this.downObj.mousedown(function(t){i(t)})},this.reset=function(t){this.handle=t.handle,this.canDrag=t.canDrag!==!1,this.axis=t.axis||"xy",this.area=t.area||[],this.inwin=t.inwin||!1,this.cursor=t.cursor||"move",this.zIndex=t.zIndex||"",this.dragObj=Z(this.elem),this.downObj=this.handle?this.dragObj.find(this.handle):this.dragObj,this.downObj.css("cursor",this.cursor)},this.onMousedown=function(i){var r=this.dragObj[0];this.dragObj.css("position","absolute");var s=Z.viewSize();if(this.dragElemWidth=Math.max(r.offsetWidth,r.clientWidth),this.dragElemHeight=Math.max(r.offsetHeight,r.clientHeight),this.dragElemMarginTop=parseInt(r.style.marginTop,10)||0,this.dragElemMarginLeft=parseInt(r.style.marginLeft,10)||0,this.inwin){var a=s.width-this.dragElemWidth,o=s.height-this.dragElemHeight;this.area=[0,a,0,o]}var c=n.bind(this.onMousemove,this);this.mouseup=n.bind(this.onMouseup,this),this.mousemove=function(t){c(t)},window.captureEvents?(i.stopPropagation(),i.preventDefault(),t.blur(this.mouseup)):r.setCapture&&(r.setCapture(),i.cancelBubble=!0,this.dragObj.on("losecapture",this.mouseup)),this.diffX=i.clientX-r.offsetLeft,this.diffY=i.clientY-r.offsetTop,e.mousemove(this.mousemove),e.mouseup(this.mouseup),this.fire("start")},this.onMousemove=function(t){var e,n,r,s,a=t.clientX-this.diffX,o=t.clientY-this.diffY,c=this.dragObj,u=c[0],l=this.area;if(this.area&&(e=l[0],n=l[1],r=l[2],s=l[3],e>a&&(a=e),a>n&&(a=n),r>o&&(o=r),o>s&&(o=s)),this.canDrag){var h=this.axis;a-=this.dragElemMarginTop,o-=this.dragElemMarginLeft,("x"===h||i.test(h))&&(u.style.left=a+"px"),("y"===h||i.test(h))&&(u.style.top=o+"px")}this.fire("drag",a,o)},this.onMouseup=function(){var n=this.dragObj[0];e.off("mousemove",this.mousemove),e.off("mouseup",this.mouseup),window.releaseEvents?t.off("blur",this.mouseup):dargElem.releaseCapture&&(dragObj.off("losecapture",this.mouseup),n.releaseCapture()),this.fire("end")},this.stopDrag=function(){this.canDrag=!1},this.startDrag=function(){this.canDrag=!0},this.setAxis=function(t){this.axis=t}}),Z.declareUI("Tab",function(){Z.Function,this.init=function(t,e){var e=e||{};this.elem=Z.isElement(t)?t:Z(t)[0],this.eventType=e.eventType||"mouseover",this.currClass=e.currClass||"curr",this.autoPlay=e.autoPlay||!1,this.interval=e.interval||5e3,this.currIndex=e.currIndex||0,this.attrName=e.attrName||"data-ui",this.tabNavVal=e.tabNavVal||"tab-nav",this.tabConVal=e.tabConVal||"tab-content";var n=this.attrName,i=this.tabNavVal,r=this.tabConVal,s=this.elemObj=Z(this.elem),a=this.navObj=s.find("["+n+"="+i+"]"),o=this.contentObj=s.find("["+n+"="+r+"]");if(a.length!=o.length)throw Error("navObj and contentObj length must be equal");this.length=a.length,this.currIndex&&(a.removeClass(this.currClass),o.hide(),this.change(this.currIndex)),this.autoPlay&&this.play();var c=this;s.delegate("["+n+"="+i+"]",this.eventType,function(){var t=a.index(this);c.change(t)})},this.change=function(t){var e=this.navObj,n=this.contentObj,i=this.currClass,r=e.eq(t),s=n.eq(t);this._preNav=this._preNav?this._preNav:r,this._preCon=this._preCon?this._preCon:s,this._preNav.removeClass(i),r.addClass(i),this._preNav=r,this._preCon.hide(),s.show(),this._preCon=s,this.currIndex=t,this.fire("change",t)},this.play=function(){var t=this;this.timer=setInterval(function(){var e=t.currIndex+1;e===t.length&&(e=0),t.change(e)},this.interval)},this.stop=function(){clearInterval(this.timer)}}),Z.declareUI("Suggest",function(){function t(t,e){var n=document.createElement(t);return e&&(n.className=e),Z(n)}this.init=function(e,n){this.input=Z(e),this.ulCls=n.ulCls||"",this.liCls=n.liCls||"suggest-li",this.currCls=n.currCls||"curr",this.url=n.url||"",this.data=n.data||[],this.processData=n.processData||function(t){return t},this.processLi=n.processLi||function(t){return t},this.processVal=n.processVal||function(t){return t},this.currLi=null;var i=this.input.offset();this.div=t("div","suggest-div").hide(),this.div.css({position:"absolute",top:i.top+this.input[0].offsetHeight-1,left:i.left,width:this.input[0].offsetWidth-2}),this.ul=t("ul",n.ulCls),this.div.append(this.ul),Z(document.body).append(this.div),this.events(),this.fire("init")},this.events=function(){this.input.on("keyup",{context:this,handler:function(t){""===this.input.value?this.hide():this.onKeyup(t)}}).on("blur",{context:this,handler:function(){this.hide()}});var t=this,e=t.currCls;this.ul.delegate("li","mousedown",function(){var e=Z(this);t.input.val(e.attr("data-val"))}).delegate("li","mouseover",function(){var n=Z(this);n.addClass(e),t.currLi=n}).delegate("li","mouseout",function(){var t=Z(this);t.removeClass(e)})},this.hide=function(){this.div.hide(),this.visible=!1,this.fire("hide")},this.show=function(){this.div.show(),this.visible=!0,this.fire("show")},this.render=function(){var e=this.input.val();return""===e?(this.hide(),void 0):(this.ul.empty(),Z.each(this.data,function(n){var i=t("li",this.liCls),r=this.processVal(n,e);i.attr("data-val",r),i.html(this.processLi(n,e)),this.ul.append(i)},this),this.visible=!0,this.show(),this.fire("render"),void 0)},this.specKeys=function(t){var e=this.ul,n=e.find("li"),i=this.input,r=this.currLi;this.liCls;var s=this.currCls;switch(t){case 13:return r&&(i.val(r.attr("data-val")),this.hide()),void 0;case 38:return null==r?(this.currLi=n.last(),this.currLi.addClass(s),i.val(this.currLi.attr("data-val"))):this.currLi.prev().length?(this.currLi.removeClass(s),this.currLi=this.currLi.prev(),this.currLi.addClass(s),i.val(this.currLi.attr("data-val"))):(this.currLi.removeClass(s),this.currLi=null,i[0].focus(),i.val(this.finalValue)),void 0;case 40:return null==r?(this.currLi=n.first(),this.currLi.addClass(s),i.val(this.currLi.attr("data-val"))):this.currLi.next().length?(this.currLi.removeClass(s),this.currLi=this.currLi.next(),this.currLi.addClass(s),i.val(this.currLi.attr("data-val"))):(this.currLi.removeClass(s),this.currLi=null,i[0].focus(),i.val(this.finalValue)),void 0;case 27:return this.hide(),i.val(this.finalValue),void 0}},this.onKeyup=function(t){var e=this,n=this.input,i=t.keyCode;if(13!==i&&27!==i&&38!==i&&40!==i||!this.visible){this.lis=[];var r=n.val();this.finalValue!==r&&(this.url?Z.get(this.url,function(t){e.data=e.processData(t),e.render()}):this.render(),this.finalValue=r)}else this.specKeys(i)}}),Z.declareUI("Calendar",function(){this.init=function(t,e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.hasDay=e.hasDay,this.startDate=e.startDate,this.endDate=e.endDate,this.chosenDate=e.chosenDate,this.dateCls=e.dateCls||"day",this.chosenCls=e.chosenCls||"chosen",this.dateOverCls=e.dateOverCls||"over",this.prevHook=e.prevHook||".prev",this.nextHook=e.nextHook||".next",this.closeHook=e.closeHook||".close",this.todayHook=e.todayHook||".today",this.yearHook=e.yearHook||"[data-cal=year]",this.monthHook=e.monthHook||"[data-cal=month]",this.currDate=new Date,this.input=Z(t);var n=this;this.input.click(function(){var t=Z(this);t.data("hasDatepicker")||n.render()})},this.setPosi=function(){var t=this.input.offset(),e=this.input.outerHeight(),n=(this.x?this.x-0:0)+t.left,i=(this.y?this.y-0:0)+t.top+e;this.div.css({position:"absolute",left:n,top:i})},this.onBodyClick=function(t){var e=Z(t.target);e.closest(".o-datepicker").length||e[0]==this.input[0]||this.remove()},this.template=function(){var t='<table cellpadding="0" cellpadding="0" class="ui-calendar-table"><thead><tr><th class="prev"><i></i></th><th colspan="5" class="switch"><span data-cal="year"></span>年<span data-cal="month"></span>月</th><th class="next"><i></i></th></tr><tr><th>日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th>六</th></tr></thead><tbody></tbody><tfoot><tr><td colspan="7"></td></tr></tfoot></table>',e=Z.dom(t)[0];e=Z(e),e.find("tfoot").html('<td colspan="2"><span class="today">今天</span></td><td></td><td></td><td></td><td colspan="2"><span class="close">关闭</span></td>');for(var n="<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>",i=[],r=0;6>r;r++)i[r]=n;e.find("tbody").html(i.join(""));var s=Z.dom('<div class="o-datepicker ui-calendar"></div>');return s=Z(s),s.append(e)},this.render=function(){var t=this.input,e=this.currDate,n=this.chosenDate,i=Z.ui.Calendar.reDate,r=t.val();if(r&&i.test(r))r=r.split("-"),this.currDate=new Date(r[0],r[1]-1,r[2]);else if(Z.isDate(n))this.currDate=n;else if(i.test(n)){var s=n.split("-");this.currDate=new Date(s[0],s[1]-1,s[2])}this.div=this.template();var a=this.table=this.div.find("table"),o=a.find(this.yearHook),c=a.find(this.monthHook),u=e.getMonth(),l=e.getFullYear();11==u?(o.text(l),c.text(u+1)):(o.text(l),c.text(u+1)),this.fillDate(),this.events(),t.data("hasDatepicker",!0),this.setPosi(),Z("body").append(this.div)},this.fillDate=function(){var t=this.currDate,e=this.startDate,n=this.endDate,i=Z.ui.Calendar.reDate,r=Z.ui.Calendar.months,s=this.table,a=s.find("tbody").find("td").empty().removeClass(),o=s.find(this.yearHook).text()-0,c=s.find(this.monthHook).text()-1,u=new Date(o,c,1);new Date;var l=u.getDay(),h=0,f=!0,d=r[c],p=r[c];1==c&&(0==o%4&&0!=o%100||0==o%400)&&(p=29);for(var v=0;p>v;v++){var m=a.eq(v+l);m.text(v+1),v+1==t.getDate()&&c==t.getMonth()&&o==t.getFullYear()&&m.addClass(this.chosenCls)}if(e&&i.test(e)){var g=e.split("-"),y=g[0]-0,b=g[1]-1,x=g[2]-1;c==b&&o==y&&(h=x),(y>o||b>c&&y>=o)&&(f=!1)}if(n&&i.test(n)){var g=n.split("-"),y=g[0]-0,b=g[1]-1;c==b&&o==y&&(d=g[2]),(o>y||c>b&&o==y)&&(f=!1)}if(f)for(var w=h;d>w;w++){var m=a.eq(w+l);m.addClass("day")}},this.events=function(){var t=this,e="."+this.dateCls,n=this.dateOverCls;this.div.delegate(e,"click",function(){var e=Z(this),n=e.closest("table"),i=n.find(t.yearHook).text(),r=n.find(t.monthHook).text()-1,s=e.text();t.currDate=new Date(i,r,s),t.remove(),t.fire("select")}).delegate(e,"mouseover",function(){Z(this).addClass(n)}).delegate(e,"mouseout",function(){Z(this).removeClass(n)}).delegate(this.todayHook,"click",function(){t.currDate=new Date,t.remove(),t.fire("select")}).delegate(this.closeHook,"click",function(){t.remove(),t.fire("close")}).delegate(this.prevHook,"click",function(){var e=Z(this);return e.hasClass("disabled")?!1:(t.prevMonth(),void 0)}).delegate(this.nextHook,"click",function(){var e=Z(this);return e.hasClass("disabled")?!1:(t.nextMonth(),void 0)}),Z(window).on("resize",{context:this,handler:this.setPosi}),Z(document).on("click",{context:this,handler:this.onBodyClick})},this.nextMonth=function(){var t=this.table.find(this.yearHook),e=this.table.find(this.monthHook),n=t.text()-0,i=e.text()-1;switch(i){case 11:t.text(n+1),e.text(1);break;case 0:t.text(n),e.text(2);break;default:i+=1,t.text(n),e.text(i+1)}this.fillDate()},this.prevMonth=function(){var t=this.table.find(this.yearHook),e=this.table.find(this.monthHook),n=t.text()-0,i=e.text()-1;switch(i){case 0:t.text(n-1),e.text(12);break;default:t.text(n),e.text(i)}this.fillDate()},this.remove=function(){this.div.remove(),this.input.val(Z.ui.Calendar.format(this.currDate,this.hasDay)),this.input.data("hasDatepicker",!1),Z(window).off("resize",this.setPosi),Z(document).off("click",this.onBodyClick)}}),Z.statics(Z.ui.Calendar,{reDate:/^\d{4}\-\d{1,2}\-\d{1,2}$/,week:["周日","周一","周二","周三","周四","周五","周六"],months:[31,28,31,30,31,30,31,31,30,31,30,31],format:function(t,e){var n,i,r,s;Z.isString(t)&&(n=t.split("-"),t=new Date(n[0],n[1]-1,n[2]));var a=t.getMonth(),o=t.getDate();i=9>a?"0"+(a+1):a+1,r=10>o?"0"+o:o;var c=t.getFullYear()+"-"+i+"-"+r;return e&&(s=week[t.getDay()],c+=" "+s),c}}),Z.declareUI("CalendarTwo",function(){function t(t,e){var i,r,s,a;Z.isString(t)&&(i=t.split("-"),t=new Date(i[0],i[1]-1,i[2]));var o=t.getMonth(),c=t.getDate();r=9>o?"0"+(o+1):o+1,s=10>c?"0"+c:c;var u=t.getFullYear()+"-"+r+"-"+s;return e&&(a=n[t.getDay()],u+=" "+a),u}function e(){var t='<table cellpadding="0" cellpadding="0" class="datepicker"><thead><tr class="controls"><th colspan="7"><span class="prevMonth"><s></s></span><span class="currDate"><span class="currYs"></span>年<span class="currMo"></span>月</span></th></tr><tr class="days"><th class="org sun">日</th><th>一</th><th>二</th><th>三</th><th>四</th><th>五</th><th class="org sat">六</th></tr></thead><tbody></tbody><tfoot><tr><td colspan="7"></td></tr></tfoot></table>',e=Z.dom(t)[0];e=Z(e),e.find("tfoot").find("td").append('<span class="today">今天</span>');var n=Z.dom(t)[0];n=Z(n),n.find(".prevMonth").replaceClass("prevMonth","nextMonth"),n.find("tfoot").find("td").append('<span class="close">关闭</span>');for(var i="<tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr>",r=[],s=0;6>s;s++)r[s]=i;e.find("tbody").html(r.join("")),n.find("tbody").html(r.join(""));var a=Z.dom('<div class="o-datepicker"></div>');return a=Z(a),a.append(e).append(n)}var n=["周日","周一","周二","周三","周四","周五","周六"],i=[31,28,31,30,31,30,31,31,30,31,30,31],r=/^\d{4}\-\d{1,2}\-\d{1,2}$/;this.init=function(t,e){e=e||{},this.x=e.x||0,this.y=e.y||0,this.hasDay=e.hasDay,this.startDate=e.startDate,this.endDate=e.endDate,this.chosenDate=e.chosenDate,this.currDate=new Date,this.input=Z(t);var n=this;this.input.click(function(){var t=Z(this);t.data("hasDatepicker")||n.render()})},this.setPosi=function(){var t=this.input.offset(),e=this.input.outerHeight(),n=(this.x?this.x-0:0)+t.left,i=(this.y?this.y-0:0)+t.top+e;this.div.css({position:"absolute",left:n,top:i})},this.onBodyClick=function(t){var e=Z(t.target);e.closest(".datepicker").length||e[0]==this.input[0]||this.remove()},this.remove=function(){this.div.remove(),this.input.val(t(this.currDate,this.hasDay)),this.input.data("hasDatepicker",!1),Z(window).off("resize",this.setPosi),Z(document).off("click",this.onBodyClick)},this.events=function(){var t=this;this.div.delegate(".date","click",function(){var e=Z(this),n=e.closest("table"),i=n.find(".currYs").text(),r=n.find(".currMo").text()-1,s=e.text();t.currDate=new Date(i,r,s),t.remove(),t.fire("select")}).delegate(".date","mouseover",function(){Z(this).addClass("over")}).delegate(".date","mouseout",function(){Z(this).removeClass("over")}).delegate(".today","click",function(){t.currDate=new Date,t.remove(),t.fire("select")}).delegate(".close","click",function(){t.remove(),t.fire("close")}).delegate(".prevMonth","click",function(){var e=Z(this);return e.hasClass("disabled")?!1:(t.prevMonth(),void 0)}).delegate(".nextMonth","click",function(){var e=Z(this);return e.hasClass("disabled")?!1:(t.nextMonth(),void 0)}),Z(window).on("resize",{context:this,handler:this.setPosi}),Z(document).on("click",{context:this,handler:this.onBodyClick})},this.render=function(){var t=this.input,n=this.currDate,i=this.chosenDate,s=t.val();if(s&&r.test(s))s=s.split("-"),this.currDate=new Date(s[0],s[1]-1,s[2]);else if(Z.isDate(i))this.currDate=i;else if(r.test(i)){var a=i.split("-");this.currDate=new Date(a[0],a[1]-1,a[2])}this.div=e();var o=this.div.find("table"),c=this.table1=o.first(),u=this.table2=o.last(),l=n.getFullYear(),h=n.getMonth();11==h?(c.find(".currYs").text(l),c.find(".currMo").text(h+1),u.find(".currYs").text(l+1),u.find(".currMo").text(1)):(c.find(".currYs").text(l),c.find(".currMo").text(h+1),u.find(".currYs").text(l),u.find(".currMo").text(h+2)),this.fillDate(),this.events(),t.data("hasDatepicker",!0),this.setPosi(),Z("body").append(this.div)},this.nextMonth=function(){var t=this.table1.find(".currYs"),e=this.table2.find(".currYs"),n=this.table1.find(".currMo"),i=this.table2.find(".currMo"),r=t.text()-0,s=e.text()-0,a=n.text()-1,o=i.text()-1;switch(o){case 11:t.text(r),n.text(12),e.text(r+1),i.text(1);break;case 0:t.text(s),n.text(1),e.text(s),i.text(2);break;default:a+=1,n.text(a+1),i.text(a+2),t.text(r),e.text(r)}this.fillDate()},this.prevMonth=function(){var t=this.table1.find(".currYs"),e=this.table2.find(".currYs"),n=this.table1.find(".currMo"),i=this.table2.find(".currMo"),r=t.text()-0;e.text()-0;var s=n.text()-1;switch(i.text()-1,s){case 11:t.text(r),n.text(11),e.text(r),i.text(12);break;case 0:t.text(r-1),n.text(12),e.text(r),i.text(1);break;default:t.text(r),e.text(r),s-=1,n.text(s+1),i.text(s+2)}this.fillDate()},this.fillDate=function(){var t=this.currDate,e=this.startDate,n=this.endDate;this.div.find("table").each(function(s,a){var o=Z(s),c=o.find("tbody").find("td").empty().removeClass(),u=o.find(".currYs").text()-0,l=o.find(".currMo").text()-1,h=new Date(u,l,1);new Date;var f=h.getDay(),d=0,p=!0,v=i[l],m=i[l];1==l&&(0==u%4&&0!=u%100||0==u%400)&&(m=29);for(var a=0;m>a;a++){var g=c.eq(a+f);g.text(a+1),a+1==t.getDate()&&l==t.getMonth()&&u==t.getFullYear()&&g.addClass("chosen")}if(e&&r.test(e)){var y=e.split("-"),b=y[0]-0,x=y[1]-1,w=y[2]-1;l==x&&u==b&&(d=w),(b>u||x>l&&b>=u)&&(p=!1)}if(n&&r.test(n)){var y=n.split("-"),b=y[0]-0,x=y[1]-1;l==x&&u==b&&(v=y[2]),(u>b||l>x&&u==b)&&(p=!1)}if(p)for(var C=d;v>C;C++){var g=c.eq(C+f);g.addClass("date")}})}}),Z.declareUI("Dialog",function(){function t(){var t='<div class="thickbox"><div class="thickwrap"><div class="thicktitle"><span></span></div><div class="thickcon"></div><a class="thickclose" href="javascript:;">×</a></div></div>',e='<div class="thickdiv"></div>',n='<iframe frameborder="0" scrolling="no" marginheight="0" marginwidth="0" class="thickframe"></iframe>';return t=Z(Z.dom(t)),e=Z(Z.dom(e)),n=Z(Z.dom(n)),[t,e,n]}this.init=function(e){this.width=e.width||200,this.height=e.height||100,this.autoReposi=e.autoReposi||!1,this.dragdrop=e.dragdrop||!0,this.title=e.title||"提示",this.content=function(){return e.content?Z.isFunction(e.content)?e.content():e.content:""}();var n=t();this.div=n[0],this.mask=n[1],this.iframe=n[2],Z("body").append(n[0]),Z("body").append(n[1]),Z("body").append(n[2]),this.setRect(this.width,this.height),this.setTitle(this.title),this.setContent(this.content),this.setPosi(),this.events(),this.dragdrop&&Z.ui.Dragdrop(this.div[0],{inwin:!0,handle:".thicktitle"}),this.fire("init")},this.setTitle=function(t){this.div.find(".thicktitle").html(t)},this.setContent=function(t){this.div.find(".thickcon").html(t)},this.setRect=function(t,e){this.div.find(".thickwrap").css({width:t+"px",height:e+"px"})},this.setPosi=function(){var t=Z.winSize(),e=(t.height-50)/2-this.div[0].clientHeight/2,n=t.width/2-this.div[0].clientWidth/2;Z.ie6&&(e+=document.documentElement.scrollTop),this.div.css({top:e,left:n})},this.events=function(){var t=this;this.div.delegate(".thickclose","click",function(){t.remove()}),this.autoReposi&&Z(window).on("resize",{context:this,handler:this.setPosi}),Z.ie6?(this.div.css("position","absolute"),Z(window).on("scroll",{context:this,handler:this.setPosi})):this.div.css("position","fixed")},this.remove=this.close=function(){this.div.remove(),this.mask.remove(),this.iframe.remove(),Z(window).off("resize",this.setPosi),this.fire("close")}});